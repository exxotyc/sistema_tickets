{# templates/tickets/index.html #}
{% extends "tickets/base.html" %}
{% load static %}

{% block title %}Inicio · Coyahue Tickets{% endblock %}

{% block extra_head %}
<style>
:root {
    --bg-a: #0ea5e9;
    --bg-b: #6366f1;
    --glass: rgba(255, 255, 255, 0.78);
    --glass-border: rgba(255, 255, 255, 0.35);
    --text-primary: #0f172a;
    --text-muted: #475569;
    --text-light: #64748b;
    --card-bg: rgba(255, 255, 255, 0.92);
}

/* Container */
.container-narrow {
    max-width: 980px;
    margin-left: auto;
    margin-right: auto;
}

/* Hero Section */
.hero {
    position: relative;
    overflow: hidden;
    border-radius: 1.5rem;
    margin: 2rem 0;
    padding: 3rem 0;
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.hero-accent {
    position: absolute;
    top: -50%;
    right: -20%;
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, var(--bg-a) 0%, transparent 70%);
    opacity: 0.1;
    z-index: 0;
}

.hero > .row {
    position: relative;
    z-index: 1;
}

.hero h1 {
    font-size: 3rem;
    font-weight: 800;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 1rem;
    line-height: 1.1;
    letter-spacing: -0.02em;
}

.hero .lead-text {
    font-size: 1.25rem;
    font-weight: 500;
    color: var(--text-muted);
    margin-bottom: 2rem;
    line-height: 1.6;
}

/* Badge improvements */
.hero .badge {
    font-weight: 600;
    letter-spacing: 0.5px;
    padding: 0.5rem 1rem;
}

/* KPI Components */
.kpi {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 1rem;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    margin-bottom: 1rem;
    transition: all 0.3s ease;
}

.kpi:hover {
    background: rgba(255, 255, 255, 0.9);
    transform: translateX(5px);
    box-shadow: 0 8px 25px rgba(2, 6, 23, 0.1);
}

.kpi-title {
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
    font-size: 1.1rem;
}

.kpi-description {
    color: var(--text-light);
    font-size: 0.9rem;
    line-height: 1.4;
}

.ring {
    position: relative;
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: conic-gradient(var(--bg-a) calc(var(--p, 0) * 360deg), #e2e8f0 0deg);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 4px 15px rgba(14, 165, 233, 0.2);
}

.ring::before {
    content: "";
    position: absolute;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: white;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.ring span {
    position: relative;
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--text-primary);
}

.spark {
    height: 4px;
    background: linear-gradient(90deg, var(--bg-a) 0%, var(--bg-b) 100%);
    border-radius: 2px;
    position: relative;
    overflow: hidden;
    margin-top: 0.5rem;
}

.spark::after {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.8) 50%, transparent 100%);
    animation: sparkle 2s infinite;
}

@keyframes sparkle {
    0% { left: -100%; }
    100% { left: 100%; }
}

/* Visualization Section */
.viz {
    position: relative;
    border-radius: 1.5rem;
    overflow: hidden;
    padding: 3rem 0;
    margin: 3rem 0;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.viz::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(14, 165, 233, 0.08) 0%, rgba(99, 102, 241, 0.08) 100%);
    z-index: 0;
}

.grid {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
        linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
    background-size: 50px 50px;
    z-index: 0;
}

.viz > .row {
    position: relative;
    z-index: 1;
}

.viz h3 {
    font-size: 2rem;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #0f172a 0%, #374151 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.viz .section-description {
    font-size: 1.1rem;
    color: var(--text-muted);
    margin-bottom: 2rem;
    font-weight: 500;
}

/* Card improvements */
.card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.card:hover {
    transform: translateY(-3px);
    box-shadow: 0 20px 40px rgba(2, 6, 23, 0.15);
}

.card-title {
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.card-text {
    color: var(--text-light);
    line-height: 1.5;
}

/* Feature cards in hero */
.feature-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
}

.feature-card strong {
    font-weight: 700;
    color: var(--text-primary);
    display: block;
    margin-bottom: 0.25rem;
}

.feature-card .text-muted {
    color: var(--text-light) !important;
    font-size: 0.9rem;
    line-height: 1.4;
}

/* Button improvements */
.btn {
    transition: all 0.3s ease;
    font-weight: 600;
    padding: 0.75rem 1.5rem;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3);
}

.btn-outline-primary:hover {
    box-shadow: 0 8px 20px rgba(14, 165, 233, 0.2);
}

/* Text utilities */
.fw-semibold {
    font-weight: 600;
}

.fw-bold {
    font-weight: 700;
}

.h-100 {
    height: 100% !important;
}

/* Section spacing */
.section-title {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 1rem;
}

/* Responsive Design */
@media (max-width: 768px) {
    .hero {
        padding: 2rem 1rem !important;
        margin: 1rem 0;
    }
    
    .hero h1 {
        font-size: 2.2rem;
    }
    
    .hero .lead-text {
        font-size: 1.1rem;
    }
    
    .kpi {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
        padding: 1.25rem;
    }
    
    .container-narrow {
        padding-left: 1rem;
        padding-right: 1rem;
    }
    
    .viz {
        padding: 2rem 1rem;
        margin: 2rem 0;
    }
    
    .viz h3 {
        font-size: 1.75rem;
    }
    
    .btn-group {
        flex-direction: column;
        width: 100%;
    }
    
    .btn-group .btn {
        width: 100%;
        margin-bottom: 0.5rem;
    }
}

@media (max-width: 576px) {
    .hero h1 {
        font-size: 1.8rem;
    }
    
    .section-title {
        font-size: 2rem;
    }
    
    .ring {
        width: 60px;
        height: 60px;
    }
    
    .ring::before {
        width: 48px;
        height: 48px;
    }
}

/* Animation for badges */
.badge {
    animation: fadeInUp 0.6s ease;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Smooth transitions */
.kpi, .card, .btn {
    transition: all 0.3s ease;
}

/* Text contrast improvements */
.text-muted {
    color: var(--text-muted) !important;
}

.text-light {
    color: var(--text-light) !important;
}

/* Icon sizing */
.bi {
    opacity: 0.9;
}
</style>
{% endblock %}

{% block content %}
<div class="container-narrow mx-auto">

  <!-- HERO -->
  <section class="hero p-4 p-md-5 mb-4">
    <div class="hero-accent"></div>
    <div class="row g-4 align-items-center">
      <div class="col-lg-7">
        <div class="d-flex align-items-center gap-2 mb-3">
          <span class="badge rounded-pill text-bg-primary">
            <i class="bi bi-lightning-charge-fill me-1"></i>Nuevo
          </span>
          <span class="badge rounded-pill badge-soft">Coyahue</span>
        </div>
        <h1 class="fw-bold mb-3">Sistema de Tickets</h1>
        <p class="lead-text">Crea, gestiona y sigue tus solicitudes con una interfaz clara y eficiente diseñada para optimizar tu flujo de trabajo.</p>

        <div class="d-flex flex-wrap gap-2">
          {% if request.user.is_authenticated %}
            <a href="{% url 'dashboard' %}" class="btn btn-primary btn-ripple">
              <i class="bi bi-speedometer2 me-1"></i> Ir al dashboard
            </a>
            <a href="{% url 'ticket_list' %}" class="btn btn-outline-primary btn-ripple">
              <i class="bi bi-list-check me-1"></i> Ver tickets
            </a>
          {% else %}
            <a href="{% url 'login' %}" class="btn btn-primary btn-ripple">
              <i class="bi bi-person-check me-1"></i> Iniciar sesión
            </a>
          {% endif %}
        </div>
      </div>

      <div class="col-lg-5">
        <div class="p-3 p-md-4 rounded-4 card feature-card">
          <div class="d-flex align-items-center gap-3 mb-3">
            <i class="bi bi-shield-lock-fill fs-1 text-primary"></i>
            <div>
              <strong>Seguridad Avanzada</strong>
              <p class="m-0 text-muted small">Sesiones protegidas y rutas privadas para garantizar la confidencialidad de tu información.</p>
            </div>
          </div>
          <hr class="my-3">
          <div class="d-flex align-items-center gap-3">
            <i class="bi bi-rocket-takeoff-fill fs-1 text-primary"></i>
            <div>
              <strong>Máxima Eficiencia</strong>
              <p class="m-0 text-muted small">Flujo optimizado para registrar, asignar y resolver incidencias rápidamente.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TARJETAS -->
  <div class="row g-4">
    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center gap-2 mb-3">
            <i class="bi bi-box-arrow-in-right text-primary fs-4"></i>
            <h5 class="card-title m-0 fw-bold">Acceso Seguro</h5>
          </div>
          <p class="card-text text-muted mb-3">Autentícate de forma segura para acceder a todas las funcionalidades del sistema de tickets.</p>
          {% if request.user.is_authenticated %}
            <a href="{% url 'dashboard' %}" class="btn btn-primary btn-ripple">Ir al dashboard</a>
          {% else %}
            <a href="{% url 'login' %}" class="btn btn-primary btn-ripple">Iniciar sesión</a>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center gap-2 mb-3">
            <i class="bi bi-journal-check text-primary fs-4"></i>
            <h5 class="card-title m-0 fw-bold">Gestión de Tickets</h5>
          </div>
          <p class="card-text text-muted mb-3">Consulta el listado completo, filtra por estado y gestiona todas tus solicitudes en un solo lugar.</p>
          {% if request.user.is_authenticated %}
            <a href="{% url 'ticket_list' %}" class="btn btn-outline-primary btn-ripple">Ver listado</a>
          {% else %}
            <a href="{% url 'login' %}" class="btn btn-outline-primary btn-ripple">Acceder para ver</a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- PANEL VISUAL -->
  <section class="mt-5">
    <div class="viz p-4 p-md-5 position-relative">
      <div class="grid"></div>
      <div class="row g-4 align-items-center">
        <div class="col-lg-6">
          <h3 class="fw-bold mb-3">Métricas de Desempeño</h3>
          <p class="section-description">Seguimiento en tiempo real del rendimiento y eficiencia del sistema de tickets.</p>

          <div class="d-flex flex-column gap-3">
            <div class="kpi">
              <div class="ring" style="--p:.78"><span>78%</span></div>
              <div>
                <div class="kpi-title">Resolución en Primer Contacto</div>
                <div class="kpi-description">Tickets resueltos sin necesidad de escalamiento</div>
                <div class="spark mt-2"></div>
              </div>
            </div>
            <div class="kpi">
              <div class="ring" style="--p:.62"><span>62%</span></div>
              <div>
                <div class="kpi-title">SLA Dentro de Tiempo</div>
                <div class="kpi-description">Cumplimiento de acuerdos de nivel de servicio</div>
                <div class="spark mt-2"></div>
              </div>
            </div>
            <div class="kpi">
              <div class="ring" style="--p:.91"><span>91%</span></div>
              <div>
                <div class="kpi-title">Satisfacción del Usuario</div>
                <div class="kpi-description">Calificación promedio de los usuarios</div>
                <div class="spark mt-2"></div>
              </div>
            </div>
          </div>

          <div class="d-flex gap-2 mt-4">
            {% if request.user.is_authenticated %}
              <a href="{% url 'dashboard' %}" class="btn btn-primary btn-ripple">
                <i class="bi bi-graph-up-arrow me-1"></i> Ver métricas completas
              </a>
              <a href="{% url 'ticket_list' %}" class="btn btn-outline-primary btn-ripple">
                <i class="bi bi-list-ul me-1"></i> Ver todos los tickets
              </a>
            {% else %}
              <a href="{% url 'login' %}" class="btn btn-primary btn-ripple">
                <i class="bi bi-lock me-1"></i> Iniciar sesión para ver métricas
              </a>
            {% endif %}
          </div>
        </div>

        <div class="col-lg-6">
          <div class="card border-0 shadow-sm">
            <div class="card-body p-3">
              <svg viewBox="0 0 560 260" width="100%" height="100%" role="img" aria-label="Gráfico de flujo de tickets mostrando el progreso y eficiencia del sistema">
                <defs>
                  <linearGradient id="g1" x1="0" y1="0" x2="1" y2="0">
                    <stop offset="0%" stop-color="#0ea5e9"/>
                    <stop offset="100%" stop-color="#6366f1"/>
                  </linearGradient>
                  <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="6" result="blur"/>
                    <feMerge>
                      <feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/>
                    </feMerge>
                  </filter>
                </defs>
                <g opacity="0.12">
                  <path d="M0 40H560M0 80H560M0 120H560M0 160H560M0 200H560" stroke="#0f172a" stroke-width="1"/>
                  <path d="M80 0V260M160 0V260M240 0V260M320 0V260M400 0V260M480 0V260" stroke="#0f172a" stroke-width="1"/>
                </g>
                <path d="M20 210 C120 120, 220 180, 300 110 S520 80, 540 160"
                      fill="none" stroke="url(#g1)" stroke-width="6" filter="url(#glow)"/>
                <circle r="8" fill="white">
                  <animateMotion dur="6s" repeatCount="indefinite"
                                 path="M20 210 C120 120, 220 180, 300 110 S520 80, 540 160"/>
                </circle>
                <g fill="#ffffff" stroke="url(#g1)" stroke-width="3">
                  <circle cx="80" cy="190" r="12"/>
                  <circle cx="220" cy="160" r="12"/>
                  <circle cx="340" cy="120" r="12"/>
                  <circle cx="480" cy="150" r="12"/>
                </g>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

</div>
{% endblock %}